---
import Layout from "@layouts/Layout.astro";
import { SITE_CONTENT } from "@config";
import type { ProjectProps } from "@types";

export function getStaticPaths() {
  return SITE_CONTENT.projects
    .filter((p) => Boolean(p.slug))
    .map((p) => ({ params: { slug: p.slug }, props: { project: p } }));
}

interface PageProps {
  project: ProjectProps;
}

const { project } = Astro.props as PageProps;

const { name, summary, image, linkPreview, linkSource, accentColor = "#2563eb" } = project;
---

<Layout>
  <article>
    <header class="mb-10 surface">
      <div class="grid gap-6 p-6 sm:grid-cols-2 sm:items-center sm:p-10">
        <div>
          <a href="/#projects" class="mb-4 inline-flex items-center text-sm text-muted hover:text-fg">‚Üê Back to Projects</a>
          <h1 class="mb-3 font-serif text-4xl font-bold tracking-tight text-fg sm:text-5xl">
            {name}
          </h1>
          <p class="text-base leading-relaxed text-muted mb-6">{summary}</p>
          <div class="flex flex-wrap gap-3">
            {linkPreview && (
              <a
                href={linkPreview}
                target="_blank"
                style={{ backgroundColor: accentColor }}
                class="inline-flex items-center rounded-lg px-5 py-2 text-sm font-medium text-white transition-colors hover:opacity-90"
                >Live Product</a
              >
            )}
            {linkSource && (
              <a
                href={linkSource}
                target="_blank"
                class="inline-flex items-center rounded-lg border border-theme px-5 py-2 text-sm font-medium text-fg transition-colors hover:bg-white/5"
                >Source Code</a
              >
            )}
          </div>
        </div>
        <div class="overflow-hidden rounded-xl border border-theme bg-page">
          <img src={image} width="800" height="500" alt={name} class="h-full w-full object-cover" />
        </div>
      </div>
      <div class="h-1 w-28 rounded-r-full" style={{ backgroundColor: accentColor }}></div>
    </header>

    <section class="grid gap-8 sm:grid-cols-2">
      <div class="surface p-6">
        <h2 class="mb-3 text-xl font-semibold text-fg">Overview</h2>
        <p class="text-muted leading-relaxed">
          This page is a brief overview for {name}. We can further expand with goals, impact, and your role. Provide me copy and I will fill it in.
        </p>
      </div>
      <div class="surface p-6">
        <h2 class="mb-3 text-xl font-semibold text-fg">Skills & Technologies</h2>
        <div class="flex flex-wrap gap-2 text-sm">
          <span class="rounded-full border border-theme px-3 py-1 text-muted">React</span>
          <span class="rounded-full border border-theme px-3 py-1 text-muted">TypeScript</span>
          <span class="rounded-full border border-theme px-3 py-1 text-muted">Astro</span>
          <span class="rounded-full border border-theme px-3 py-1 text-muted">Tailwind</span>
        </div>
      </div>
    </section>

    <section class="mt-10">
      <h2 class="mb-4 text-center font-serif text-2xl font-semibold text-fg">Our Contributors</h2>
      <div class="mx-auto grid max-w-3xl grid-cols-2 gap-6 sm:grid-cols-4">
        {[1,2,3,4].map((i) => (
          <div class="flex items-center gap-3">
            <img src="/profilepic.jpg" width="48" height="48" alt="Contributor" class="h-12 w-12 rounded-full object-cover" />
            <div>
              <p class="text-sm font-medium text-fg">Contributor {i}</p>
              <p class="text-xs text-muted">Role</p>
            </div>
          </div>
        ))}
      </div>
    </section>

    <section class="mt-10">
      <h2 class="mb-5 text-2xl font-semibold text-fg">Project Showcase</h2>
      {
        (() => {
          const items = SITE_CONTENT.projects
            .filter((p) => p.slug && p.slug !== project.slug)
            .slice(0, 6);
          return (
            <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
              {items.map((p) => (
                <article class="overflow-hidden surface shadow-sm">
                  <a href={`/projects/${p.slug}`} aria-label={`${p.name} details`}>
                    <div class="relative aspect-video w-full overflow-hidden">
                      <img
                        src={p.image}
                        alt={p.name}
                        width="600"
                        height="350"
                        class="h-full w-full object-cover object-center transition-transform duration-300 hover:scale-105"
                      />
                      <div class="absolute inset-0 bg-gradient-to-t from-black/20 to-transparent"></div>
                    </div>
                  </a>
                  <div class="px-4 py-4">
                    <h3 class="text-base font-semibold text-fg">
                      <a href={`/projects/${p.slug}`} class="hover:underline">{p.name}</a>
                    </h3>
                    <p class="mt-1 line-clamp-2 text-sm text-muted">{p.summary}</p>
                  </div>
                </article>
              ))}
            </div>
          );
        })()
      }
    </section>

    <section class="mt-12 surface p-8 text-center">
      <h3 class="mb-3 text-xl font-semibold text-fg">Interested in more about {name}?</h3>
      <p class="mb-6 text-muted">Check the links above or reach out and I can share more details.</p>
      <a href="/#projects" class="inline-flex items-center rounded-lg border border-theme px-5 py-2 text-sm font-medium text-fg transition-colors hover:bg-white/5">Back to Projects</a>
    </section>
  </article>
</Layout>
